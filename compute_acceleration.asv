function stateDerivative = compute_acceleration(state, input, forceExt)
    par = set_parameters();
    velocity = state(1:length(state)/2);
    M = mass_matrix(state);
    size(M)
    C = coriolis_matrix(state);
    size(C)
    G = gravity_matrix(state);
    size(G)
    J = jacobian_matrix(state);
    
    stateDerivative = [M\(-C*velocity+G+input+J.'*forceExt); velocity];